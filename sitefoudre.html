<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Défi : Foudre</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body {
  background:black;
  color:white;
  font-family:'Press Start 2P', monospace;
  margin:0;
  padding:0;
  text-align:center;
  overflow: hidden;
}

h1{ margin-top:20px; font-size:16px;}
#game-container{
  margin-top:20px;
  position:relative;
}

#cameras{
  display:flex;
  justify-content:space-around;
  flex-wrap:wrap;
  max-width:600px;
  margin:20px auto;
  position:relative;
}

.camera{
  width:120px;
  height:160px;
  border:3px solid white;
  margin:5px;
  position:relative;
  cursor:pointer;
  background:black;
  transition: transform 0.1s;
}

/* Animatroniques noir et blanc */
.animatronique{
  width:80px;
  height:120px;
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:none;
  border:3px solid white;
  background:black;
}

/* Variantes pour plusieurs animatroniques */
.anim1 .head{width:80px; height:60px; border:3px solid white;}
.anim1 .body{width:60px; height:60px; border:3px solid white; margin:0 auto;}
.anim2 .head{width:70px; height:55px; border:3px solid white;}
.anim2 .body{width:50px; height:65px; border:3px solid white; margin:0 auto;}
.anim3 .head{width:75px; height:60px; border:3px solid white;}
.anim3 .body{width:55px; height:60px; border:3px solid white; margin:0 auto;}
.ear{width:20px; height:20px; position:absolute; top:-10px; border:3px solid white; background:black;}
.ear.left{left:-10px;}
.ear.right{right:-10px;}
.eye{width:15px; height:15px; border-radius:50%; background:white; position:absolute; top:20px;}
.eye.left{left:15px;} .eye.right{right:15px;}
.pupil{width:7px; height:7px; border-radius:50%; background:black; position:absolute; top:4px; left:4px;}

#counter{ font-size:16px; margin-top:10px;}
#letterS{ font-size:100px; margin-top:30px; display:none; animation:blink 1s infinite;}
@keyframes blink {0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}

.message{
  position:absolute;
  font-size:16px;
  font-weight:bold;
  pointer-events:none;
  animation:fadeOut 1s forwards;
}
.message.success{ color:yellow; }
.message.fail{ color:red; }
@keyframes fadeOut{
  0%{opacity:1;}
  100%{opacity:0; top:0;}
}
</style>
</head>
<body>
<h1>Clique sur les animatroniques lorsqu'ils apparaîssent !</h1>
<div id="game-container">
  <div id="cameras">
    <div class="camera" data-id="0"><div class="animatronique anim1"><div class="head"><div class="ear left"></div><div class="ear right"></div><div class="eye left"><div class="pupil"></div></div><div class="eye right"><div class="pupil"></div></div></div><div class="body"></div></div></div>
    <div class="camera" data-id="1"><div class="animatronique anim2"><div class="head"><div class="ear left"></div><div class="ear right"></div><div class="eye left"><div class="pupil"></div></div><div class="eye right"><div class="pupil"></div></div></div><div class="body"></div></div></div>
    <div class="camera" data-id="2"><div class="animatronique anim3"><div class="head"><div class="ear left"></div><div class="ear right"></div><div class="eye left"><div class="pupil"></div></div><div class="eye right"><div class="pupil"></div></div></div><div class="body"></div></div></div>
    <div class="camera" data-id="3"><div class="animatronique anim1"><div class="head"><div class="ear left"></div><div class="ear right"></div><div class="eye left"><div class="pupil"></div></div><div class="eye right"><div class="pupil"></div></div></div><div class="body"></div></div></div>
  </div>
  <div id="counter">Succès : 0 / 10</div>
  <div id="letterS">S</div>
</div>

<script>
const cameras = document.querySelectorAll('.camera');
const gameContainer = document.getElementById('game-container');
let currentId = -1;
let success = 0;
const maxSuccess = 10;
const counter = document.getElementById('counter');
const letterS = document.getElementById('letterS');
const failMessages = ["raté","trop guez","fait un effort","bro plz","encore raté"];

function hideAll(){
  cameras.forEach(c=>{
    c.querySelector('.animatronique').style.display='none';
  });
}

function spawnAnimatronic(){
  hideAll();
  currentId = Math.floor(Math.random()*cameras.length);
  const anim = cameras[currentId].querySelector('.animatronique');
  anim.style.display='block';
  setTimeout(()=>{ 
    anim.style.display='none'; 
    currentId=-1; 
  },1200);
}

function shakeSite(){
  gameContainer.style.transform='translateX(-5px)';
  setTimeout(()=>{ gameContainer.style.transform='translateX(5px)'; },50);
  setTimeout(()=>{ gameContainer.style.transform='translateX(-5px)'; },100);
  setTimeout(()=>{ gameContainer.style.transform='translateX(5px)'; },150);
  setTimeout(()=>{ gameContainer.style.transform='translateX(0)'; },200);
}

function showMessage(text, type){
  const msg = document.createElement('div');
  msg.className='message '+type;
  msg.textContent=text;
  msg.style.left = Math.random()*(window.innerWidth-100)+'px';
  msg.style.top = Math.random()*(window.innerHeight-50)+'px';
  document.body.appendChild(msg);
  setTimeout(()=>{ document.body.removeChild(msg); },1000);
}

cameras.forEach(cam=>{
  cam.addEventListener('click', ()=>{
    const id = parseInt(cam.dataset.id);
    if(id === currentId){
      success++;
      counter.textContent=`Succès : ${success} / ${maxSuccess}`;
      showMessage("+1 point","success");
      shakeSite(); // tremble seulement sur succès
      if(success>=maxSuccess){
        letterS.style.display='block';
        hideAll();
        showMessage("Bravo ! Lettre S débloquée !","success");
      } else {
        spawnAnimatronic();
      }
    } else {
      success = Math.max(0, success-1);
      counter.textContent=`Succès : ${success} / ${maxSuccess}`;
      const failMsg = failMessages[Math.floor(Math.random()*failMessages.length)];
      showMessage(failMsg,"fail"); // texte rouge sur échec
      // PAS de shake ici
    }
  });
});

spawnAnimatronic();
setInterval(()=>{
  if(success<maxSuccess){
    spawnAnimatronic();
  }
},1500);
</script>
</body>
</html>
