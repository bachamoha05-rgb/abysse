<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Défi : Foudre</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body{
  background:black;
  color:white;
  font-family:'Press Start 2P', monospace;
  margin:0;
  padding:0;
  text-align:center;
  overflow:hidden;
}

h1{
  margin-top:20px;
  font-size:16px;
}

#game-container{
  margin-top:20px;
  position:relative;
}

/* Effet scan */
body::after{
  content:"";
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:repeating-linear-gradient(
    0deg,
    rgba(255,255,255,0.03),
    rgba(255,255,255,0.03) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events:none;
}

#cameras{
  display:flex;
  justify-content:space-around;
  flex-wrap:wrap;
  max-width:600px;
  margin:20px auto;
}

.camera{
  width:120px;
  height:160px;
  border:3px solid white;
  margin:5px;
  position:relative;
  cursor:pointer;
  background:black;
  overflow:hidden;
}

/* GIF animatronique */
.animatronique{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  width:100%;
  height:100%;
  object-fit:contain;
  display:none;
  image-rendering:pixelated;
  filter:grayscale(100%) brightness(70%) contrast(180%);
  animation:glitch 0.15s infinite;
}

@keyframes glitch{
  0%{ transform:translate(-50%,-50%);}
  50%{ transform:translate(-49%,-51%);}
  100%{ transform:translate(-50%,-50%);}
}

#counter{
  font-size:16px;
  margin-top:10px;
}

#letterS{
  font-size:100px;
  margin-top:30px;
  display:none;
  animation:blink 1s infinite;
}

@keyframes blink{
  0%{opacity:1;}
  50%{opacity:0;}
  100%{opacity:1;}
}

.message{
  position:absolute;
  font-size:16px;
  font-weight:bold;
  pointer-events:none;
  animation:fadeOut 1s forwards;
}

.message.success{ color:yellow;}
.message.fail{ color:red;}

@keyframes fadeOut{
  0%{opacity:1;}
  100%{opacity:0; top:0;}
}
</style>
</head>

<body>

<h1>Clique sur le signal lorsqu'il apparaît !</h1>

<div id="game-container">

<div id="cameras">

<!-- Caméras -->
<div class="camera" data-id="0">
  <img class="animatronique" src="https://media.tenor.com/mrTqSKlOCgQAAAAM/purple-guy.gif">
</div>

<div class="camera" data-id="1">
  <img class="animatronique" src="https://media.tenor.com/mrTqSKlOCgQAAAAM/purple-guy.gif">
</div>

<div class="camera" data-id="2">
  <img class="animatronique" src="https://media.tenor.com/mrTqSKlOCgQAAAAM/purple-guy.gif">
</div>

<div class="camera" data-id="3">
  <img class="animatronique" src="https://media.tenor.com/mrTqSKlOCgQAAAAM/purple-guy.gif">
</div>

</div>

<div id="counter">Succès : 0 / 10</div>
<div id="letterS">S</div>

</div>

<script>
const cameras = document.querySelectorAll('.camera');

let currentId=-1;
let success=0;
const maxSuccess=10;
const counter=document.getElementById('counter');
const letterS=document.getElementById('letterS');
const failMessages=["raté","trop guez","fait un effort","bro plz","encore raté"];

function hideAll(){
  cameras.forEach(c=>{
    c.querySelector('.animatronique').style.display='none';
  });
}

function spawn(){
  hideAll();
  currentId=Math.floor(Math.random()*cameras.length);
  const anim=cameras[currentId].querySelector('.animatronique');
  anim.style.display='block';
  setTimeout(()=>{
    anim.style.display='none';
    currentId=-1;
  },1200);
}

function showMessage(text,type){
  const msg=document.createElement('div');
  msg.className='message '+type;
  msg.textContent=text;
  msg.style.left=Math.random()*(window.innerWidth-100)+'px';
  msg.style.top=Math.random()*(window.innerHeight-50)+'px';
  document.body.appendChild(msg);
  setTimeout(()=>{document.body.removeChild(msg);},1000);
}

cameras.forEach(cam=>{
  cam.addEventListener('click',()=>{
    const id=parseInt(cam.dataset.id);
    if(id===currentId){
      success++;
      counter.textContent=`Succès : ${success} / ${maxSuccess}`;
      showMessage("+1 point","success");
      if(success>=maxSuccess){
        letterS.style.display='block';
        hideAll();
        showMessage("Bravo ! Lettre S débloquée !","success");
      } else{
        spawn();
      }
    } else{
      success=Math.max(0,success-1);
      counter.textContent=`Succès : ${success} / ${maxSuccess}`;
      const failMsg=failMessages[Math.floor(Math.random()*failMessages.length)];
      showMessage(failMsg,"fail");
    }
  });
});

spawn();
setInterval(()=>{
  if(success<maxSuccess){
    spawn();
  }
},1500);
</script>

</body>
</html>
